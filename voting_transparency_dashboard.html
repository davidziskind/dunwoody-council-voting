<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dunwoody City Council - Voting Results</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .disclaimer {
            background: rgba(255, 243, 205, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid #f6ad55;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            line-height: 1.5;
            color: #744210;
        }

        .disclaimer a {
            color: #2b6cb0;
            text-decoration: none;
            font-weight: 500;
        }

        .disclaimer a:hover {
            text-decoration: underline;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #4a5568;
            margin-bottom: 1rem;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-radius: 12px;
            min-width: 120px;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: #4a5568;
            font-size: 1.1rem;
        }

        .error {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #f56565;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
            color: #742a2a;
        }

        .attendance-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .attendance-section h2 {
            font-size: 1.8rem;
            color: #2d3748;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            overflow-x: auto;
            display: block;
            white-space: nowrap;
        }

        .attendance-table thead,
        .attendance-table tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        .attendance-table th,
        .attendance-table td {
            padding: 0.8rem;
            text-align: center;
            border-bottom: 1px solid #e2e8f0;
            width: calc(100% / 8);
        }

        .attendance-table th {
            background: #f7fafc;
            font-weight: 600;
            color: #2d3748;
            position: sticky;
            top: 0;
        }

        .attendance-table th:first-child,
        .attendance-table td:first-child {
            width: 120px;
            text-align: left;
            font-weight: 500;
        }

        .attendance-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        .present {
            background: #48bb78;
        }

        .zoom {
            background: #4299e1;
        }

        .absent {
            background: #f56565;
        }

        .attendance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .summary-card {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .summary-name {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }

        .summary-stats {
            font-size: 0.9rem;
            color: #4a5568;
        }

        .attendance-rate {
            font-weight: bold;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        .rate-excellent {
            color: #48bb78;
        }

        .rate-good {
            color: #4299e1;
        }

        .rate-poor {
            color: #f56565;
        }

        .meeting-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .meeting-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .meeting-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .meeting-date {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2d3748;
        }

        .meeting-status {
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .status-completed {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
        }

        .status-upcoming {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
            color: white;
        }

        .meeting-attendance {
            margin-bottom: 1rem;
            padding: 1rem;
            background: #f7fafc;
            border-radius: 8px;
        }

        .attendance-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2d3748;
        }

        .attendance-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .attendance-member {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.3rem 0.6rem;
            background: white;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .motion-item {
            background: #f7fafc;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .motion-item:hover {
            background: #edf2f7;
            transform: translateX(5px);
        }

        .motion-item.passed {
            border-left-color: #48bb78;
        }

        .motion-item.failed {
            border-left-color: #f56565;
        }

        .motion-item.tabled {
            border-left-color: #ed8936;
        }

        .motion-meta {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-style: italic;
            background: rgba(102, 126, 234, 0.1);
            padding: 0.5rem;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }

        .motion-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }

        .motion-description {
            color: #4a5568;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .voting-results {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .vote-summary {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .vote-count {
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .vote-yes {
            background: #c6f6d5;
            color: #22543d;
        }

        .vote-no {
            background: #fed7d7;
            color: #742a2a;
        }

        .vote-abstain {
            background: #feebc8;
            color: #744210;
        }

        .motion-result {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .result-passed {
            background: #c6f6d5;
            color: #22543d;
        }

        .result-failed {
            background: #fed7d7;
            color: #742a2a;
        }

        .result-tabled {
            background: #feebc8;
            color: #744210;
        }

        .council-members {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .member-vote {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0.8rem;
            background: white;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .member-name {
            font-weight: 500;
            color: #2d3748;
        }

        .vote-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .vote-yes-indicator {
            background: #48bb78;
        }

        .vote-no-indicator {
            background: #f56565;
        }

        .vote-abstain-indicator {
            background: #ed8936;
        }

        .search-filter {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .filter-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-input, .filter-select {
            padding: 0.8rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: white;
        }

        .search-input:focus, .filter-select:focus {
            outline: none;
            border-color: #4facfe;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .stats-bar {
                gap: 1rem;
            }

            .stat-item {
                min-width: 100px;
                padding: 0.8rem;
            }

            .meeting-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .voting-results {
                flex-direction: column;
                align-items: flex-start;
            }

            .vote-summary {
                width: 100%;
            }

            .attendance-table {
                font-size: 0.8rem;
            }

            .attendance-summary {
                grid-template-columns: 1fr;
            }
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: #4a5568;
            font-style: italic;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .public-hearing-section {
            background: #e6fffa;
            border-left: 4px solid #38b2ac;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .public-hearing-title {
            font-weight: 600;
            color: #234e52;
            margin-bottom: 0.5rem;
        }

        .public-hearing-content {
            color: #2d3748;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="disclaimer">
            <p><strong>Disclaimer:</strong> This site is a personal project of David Ziskind and is not affiliated with the City of Dunwoody. The data is aggregated from city council meeting minutes. Due to factors including revised minutes and human error, this data is not guaranteed, and you should verify it by viewing the official meeting minutes available <a href="https://www.dunwoodyga.gov/government/agendas-and-minutes" target="_blank">here</a>. Please bring any errors to my attention to be addressed promptly.</p>
        </div>

        <header>
            <div class="header-content">
                <h1>Dunwoody City Council</h1>
                <p class="subtitle">Voting Transparency Dashboard</p>
                <div class="stats-bar">
                    <div class="stat-item">
                        <span class="stat-number" id="totalMeetings">0</span>
                        <span class="stat-label">Meetings</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalMotions">0</span>
                        <span class="stat-label">Motions</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="loading" id="loadingIndicator">Loading meeting data...</div>

        <div class="attendance-section" id="attendanceSection" style="display: none;">
            <h2>Attendance Summary</h2>
            <div class="legend">
                <div class="legend-item">
                    <div class="attendance-indicator present">P</div>
                    <span>Present</span>
                </div>
                <div class="legend-item">
                    <div class="attendance-indicator zoom">Z</div>
                    <span>Zoom</span>
                </div>
                <div class="legend-item">
                    <div class="attendance-indicator absent">A</div>
                    <span>Absent</span>
                </div>
            </div>
            
            <div style="overflow-x: auto;">
                <table class="attendance-table" id="attendanceTable">
                    <thead>
                        <tr>
                            <th>Member</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="attendance-summary" id="attendanceSummary"></div>
        </div>

        <div class="search-filter" id="searchFilter" style="display: none;">
            <div class="filter-controls">
                <input type="text" class="search-input" placeholder="Search motions, descriptions, or council members..." id="searchInput">
                <select class="filter-select" id="statusFilter">
                    <option value="">All Results</option>
                    <option value="passed">Passed</option>
                    <option value="failed">Failed</option>
                    <option value="tabled">Tabled</option>
                </select>
                <select class="filter-select" id="memberFilter">
                    <option value="">All Members</option>
                </select>
                <select class="filter-select" id="dateFilter">
                    <option value="">All Dates</option>
                    <option value="2025">2025</option>
                    <option value="2024">2024</option>
                </select>
            </div>
        </div>

        <div id="meetingsContainer"></div>
    </div>

    <script>
        // Configuration and data management
        class DunwoodyVotingTracker {
            constructor() {
                this.councilMembers = [
                    "Mayor Deutsch",
                    "Harris", 
                    "Heneghan",
                    "Lambert", 
                    "Lautenbacher",
                    "Price",
                    "Seconder"
                ];
                
                this.meetings = [];
                
                // Fixed file paths to match your actual JSON files
                this.meetingFiles = [
                    'meeting_2025-03-24.json',
					'meeting_2025-04-14.json',
					'meeting_2025-04-28.json',
					'meeting_2025-05-12.json',
					'meeting_2025-05-27.json',
					'meeting_2025_06_16.json',
                    'meeting_2025_06_30.json',
                    'meeting_2025_07_14.json',
                    'meeting_2025_07_28.json',
                    'meeting_2025_08_25.json',
                    'meeting_2025_09_08.json'
                ];
                
                this.init();
            }

            async init() {
                try {
                    await this.loadAllMeetings();
                    this.generateUI();
                    this.setupEventListeners();
                    this.hideLoading();
                } catch (error) {
                    this.showError('Failed to load meeting data. Please check the browser console for details.');
                    console.error('Initialization error:', error);
                }
            }

            async loadAllMeetings() {
                const loadingPromises = this.meetingFiles.map(file => this.loadMeetingFile(file));
                const results = await Promise.allSettled(loadingPromises);
                
                // Process successful loads and handle failures gracefully
                results.forEach((result, index) => {
                    if (result.status === 'fulfilled') {
                        this.meetings.push(result.value);
                        console.log(`Successfully loaded: ${this.meetingFiles[index]}`);
                    } else {
                        console.warn(`Failed to load meeting file ${this.meetingFiles[index]}:`, result.reason);
                    }
                });
                
                // Sort meetings by date (newest first)
                this.meetings.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                console.log(`Total meetings loaded: ${this.meetings.length}`);
            }

            async loadMeetingFile(filename) {
                try {
                    const response = await fetch(filename);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status} for file: ${filename}`);
                    }
                    
                    const meetingData = await response.json();
                    
                    // Validate the data structure
                    this.validateMeetingData(meetingData, filename);
                    
                    return meetingData;
                } catch (error) {
                    console.error(`Error loading ${filename}:`, error);
                    throw error;
                }
            }

            validateMeetingData(data, filename) {
                const requiredFields = ['date', 'status', 'attendance', 'motions'];
                
                for (const field of requiredFields) {
                    if (!(field in data)) {
                        console.warn(`Missing required field '${field}' in ${filename}`);
                    }
                }
                
                // Log structure for debugging
                console.log(`Data structure for ${filename}:`, {
                    date: data.date,
                    status: data.status,
                    attendanceCount: Object.keys(data.attendance || {}).length,
                    motionsCount: (data.motions || []).length,
                    publicHearingsCount: (data.publicHearings || []).length
                });
            }

            generateUI() {
                this.updateStats();
                this.generateAttendanceSection();
                this.generateMeetingSections();
                this.populateFilters();
            }

            updateStats() {
                const totalMeetings = this.meetings.length;
                const totalMotions = this.meetings.reduce((sum, meeting) => sum + (meeting.motions || []).length, 0);
                
                document.getElementById('totalMeetings').textContent = totalMeetings;
                document.getElementById('totalMotions').textContent = totalMotions;
            }

            generateAttendanceSection() {
                const completedMeetings = this.meetings.filter(m => m.status === "completed");
                if (completedMeetings.length === 0) return;
                
                document.getElementById('attendanceSection').style.display = 'block';
                this.generateAttendanceTable();
                this.generateAttendanceSummary();
            }

            generateAttendanceTable() {
                const table = document.getElementById('attendanceTable');
                const completedMeetings = this.meetings.filter(m => m.status === "completed");
                
                // Generate header
                const header = table.querySelector('thead tr');
                header.innerHTML = '<th>Member</th>';
                completedMeetings.forEach(meeting => {
                    const th = document.createElement('th');
                    th.textContent = meeting.date.split(',')[0].replace(/\s+\d{4}$/, ''); // Remove year for space
                    header.appendChild(th);
                });

                // Generate body
                const tbody = table.querySelector('tbody');
                tbody.innerHTML = '';
                
                this.councilMembers.forEach(member => {
                    const row = document.createElement('tr');
                    const nameCell = document.createElement('td');
                    nameCell.textContent = member;
                    row.appendChild(nameCell);
                    
                    completedMeetings.forEach(meeting => {
                        const cell = document.createElement('td');
                        const status = meeting.attendance[member] || "absent";
                        const indicator = document.createElement('div');
                        
                        // Handle different attendance status formats
                        let indicatorClass = 'absent';
                        let indicatorText = 'A';
                        
                        if (status.includes('present')) {
                            if (status.includes('Zoom') || status.includes('via Zoom')) {
                                indicatorClass = 'zoom';
                                indicatorText = 'Z';
                            } else {
                                indicatorClass = 'present';
                                indicatorText = 'P';
                            }
                        }
                        
                        indicator.className = `attendance-indicator ${indicatorClass}`;
                        indicator.textContent = indicatorText;
                        cell.appendChild(indicator);
                        row.appendChild(cell);
                    });
                    
                    tbody.appendChild(row);
                });
            }

            generateAttendanceSummary() {
                const memberStats = this.calculateAttendanceStats();
                const summaryContainer = document.getElementById('attendanceSummary');
                summaryContainer.innerHTML = '';
                
                this.councilMembers.forEach(member => {
                    const stats = memberStats[member];
                    const attendanceRate = stats.total > 0 ? 
                        Math.round(((stats.present + stats.zoom) / stats.total) * 100) : 0;
                    
                    const card = document.createElement('div');
                    card.className = 'summary-card';
                    
                    let rateClass = 'rate-excellent';
                    if (attendanceRate < 90) rateClass = 'rate-good';
                    if (attendanceRate < 75) rateClass = 'rate-poor';
                    
                    card.innerHTML = `
                        <div class="summary-name">${member}</div>
                        <div class="summary-stats">
                            Present: ${stats.present} | Zoom: ${stats.zoom} | Absent: ${stats.absent}
                        </div>
                        <div class="attendance-rate ${rateClass}">
                            ${attendanceRate}%
                        </div>
                    `;
                    
                    summaryContainer.appendChild(card);
                });
            }

            calculateAttendanceStats() {
                const completedMeetings = this.meetings.filter(m => m.status === "completed");
                const memberStats = {};
                
                this.councilMembers.forEach(member => {
                    memberStats[member] = {
                        present: 0,
                        zoom: 0,
                        absent: 0,
                        total: completedMeetings.length
                    };
                });

                completedMeetings.forEach(meeting => {
                    this.councilMembers.forEach(member => {
                        const status = meeting.attendance[member] || "absent";
                        
                        if (status.includes('present')) {
                            if (status.includes('Zoom') || status.includes('via Zoom')) {
                                memberStats[member].zoom++;
                            } else {
                                memberStats[member].present++;
                            }
                        } else {
                            memberStats[member].absent++;
                        }
                    });
                });

                return memberStats;
            }

            generateMeetingSections() {
                const meetingsContainer = document.getElementById('meetingsContainer');
                meetingsContainer.innerHTML = '';
                
                this.meetings.forEach(meeting => {
                    const meetingElement = this.createMeetingElement(meeting);
                    meetingsContainer.appendChild(meetingElement);
                });
            }

            createMeetingElement(meeting) {
                const meetingDiv = document.createElement('div');
                meetingDiv.className = 'meeting-section';
                
                const statusClass = meeting.status === 'completed' ? 'status-completed' : 'status-upcoming';
                const statusText = meeting.status === 'completed' ? 'Completed' : 'Upcoming';
                
                let attendanceHTML = '';
                if (meeting.status === 'completed' && meeting.attendance && Object.keys(meeting.attendance).length > 0) {
                    const attendanceList = this.councilMembers.map(member => {
                        const status = meeting.attendance[member] || "absent";
                        let indicatorClass = 'absent';
                        let indicatorText = 'A';
                        
                        if (status.includes('present')) {
                            if (status.includes('Zoom') || status.includes('via Zoom')) {
                                indicatorClass = 'zoom';
                                indicatorText = 'Z';
                            } else {
                                indicatorClass = 'present';
                                indicatorText = 'P';
                            }
                        }
                        
                        const indicator = `<div class="attendance-indicator ${indicatorClass}">${indicatorText}</div>`;
                        return `<div class="attendance-member">${indicator} ${member}</div>`;
                    }).join('');
                    
                    attendanceHTML = `
                        <div class="meeting-attendance">
                            <div class="attendance-title">Attendance</div>
                            <div class="attendance-list">${attendanceList}</div>
                        </div>
                    `;
                }
                
                // Add public hearings if they exist
                let publicHearingsHTML = '';
                if (meeting.publicHearings && meeting.publicHearings.length > 0) {
                    const hearingsHTML = meeting.publicHearings.map(hearing => `
                        <div class="public-hearing-section">
                            <div class="public-hearing-title">${hearing.title}</div>
                            <div class="public-hearing-content">
                                ${hearing.description}
                                ${hearing.proposedRate ? `<br><strong>Proposed Rate:</strong> ${hearing.proposedRate}` : ''}
                                ${hearing.recommendation ? `<br><strong>Recommendation:</strong> ${hearing.recommendation}` : ''}
                            </div>
                        </div>
                    `).join('');
                    
                    publicHearingsHTML = `
                        <div style="margin-bottom: 1rem;">
                            <h3 style="margin-bottom: 1rem; color: #2d3748;">Public Hearings</h3>
                            ${hearingsHTML}
                        </div>
                    `;
                }
                
                let motionsHTML = '';
                if (meeting.status === 'upcoming' || !meeting.motions || meeting.motions.length === 0) {
                    motionsHTML = `
                        <div style="text-align: center; padding: 2rem; color: #4a5568; font-style: italic;">
                            ${meeting.status === 'upcoming' 
                                ? 'Voting results will generally be updated within a few days of when the meeting minutes are posted on the City of Dunwoody website.' 
                                : 'No motions recorded for this meeting.'}
                        </div>
                    `;
                } else {
                    motionsHTML = meeting.motions.map(motion => this.createMotionHTML(motion)).join('');
                }
                
                meetingDiv.innerHTML = `
                    <div class="meeting-header">
                        <div class="meeting-date">${meeting.date}</div>
                        <div class="meeting-status ${statusClass}">${statusText}</div>
                    </div>
                    ${attendanceHTML}
                    ${publicHearingsHTML}
                    ${motionsHTML}
                `;
                
                return meetingDiv;
            }

            createMotionHTML(motion) {
                const voteCount = {
                    yes: motion.votes.filter(v => v === 'yes').length,
                    no: motion.votes.filter(v => v === 'no').length,
                    abstain: motion.votes.filter(v => v === 'abstain').length,
                    absent: motion.votes.filter(v => v === 'absent').length
                };
                
                let resultText = motion.result.toUpperCase();
                if (voteCount.yes === this.councilMembers.length) resultText = 'UNANIMOUS';
                
                const membersHTML = this.councilMembers.map((member, index) => {
                    const vote = motion.votes[index] || 'absent';
                    const indicatorClass = `vote-${vote}-indicator`;
                    return `
                        <div class="member-vote" data-member="${member.toLowerCase()}" data-vote="${vote}">
                            <span class="member-name">${member}</span>
                            <span class="vote-indicator ${indicatorClass}"></span>
                        </div>
                    `;
                }).join('');
                
                let motionMetaHTML = '';
                if (motion.introducedBy || motion.secondedBy) {
                    let metaText = '';
                    if (motion.introducedBy) {
                        metaText += `Introduced by: ${motion.introducedBy}`;
                    }
                    if (motion.secondedBy) {
                        if (metaText) metaText += ' • ';
                        metaText += `Seconded by: ${motion.secondedBy}`;
                    }
                    motionMetaHTML = `<div class="motion-meta">${metaText}</div>`;
                }
                
                return `
                    <div class="motion-item ${motion.result}" data-motion-members="${this.councilMembers.map((member, index) => `${member.toLowerCase()}:${motion.votes[index] || 'absent'}`).join(',')}">
                        <div class="motion-title">${motion.title}</div>
                        ${motionMetaHTML}
                        <div class="motion-description">${motion.description}</div>
                        <div class="voting-results">
                            <div class="vote-summary">
                                <div class="vote-count vote-yes">Yes: ${voteCount.yes}</div>
                                <div class="vote-count vote-no">No: ${voteCount.no}</div>
                                ${voteCount.abstain > 0 ? `<div class="vote-count vote-abstain">Abstain: ${voteCount.abstain}</div>` : ''}
                                ${voteCount.absent > 0 ? `<div class="vote-count vote-abstain">Absent: ${voteCount.absent}</div>` : ''}
                            </div>
                            <div class="motion-result result-${motion.result}">${resultText}</div>
                        </div>
                        <div class="council-members">
                            ${membersHTML}
                        </div>
                    </div>
                `;
            }

            populateFilters() {
                const memberFilter = document.getElementById('memberFilter');
                memberFilter.innerHTML = '<option value="">All Members</option>';
                this.councilMembers.forEach(member => {
                    const option = document.createElement('option');
                    option.value = member.toLowerCase();
                    option.textContent = member;
                    memberFilter.appendChild(option);
                });
                
                document.getElementById('searchFilter').style.display = 'block';
            }

            setupEventListeners() {
                const searchInput = document.getElementById('searchInput');
                const statusFilter = document.getElementById('statusFilter');
                const memberFilter = document.getElementById('memberFilter');
                const dateFilter = document.getElementById('dateFilter');

                const filterFn = () => this.filterMeetings();
                searchInput.addEventListener('input', filterFn);
                statusFilter.addEventListener('change', filterFn);
                memberFilter.addEventListener('change', filterFn);
                dateFilter.addEventListener('change', filterFn);

                // Add hover effects
                this.addHoverEffects();
            }

            filterMeetings() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const statusValue = document.getElementById('statusFilter').value;
                const memberValue = document.getElementById('memberFilter').value;
                const dateValue = document.getElementById('dateFilter').value;
                
                const meetings = document.querySelectorAll('.meeting-section');
                let visibleCount = 0;

                meetings.forEach(meeting => {
                    const meetingDate = meeting.querySelector('.meeting-date').textContent;
                    const motions = meeting.querySelectorAll('.motion-item');
                    let meetingHasVisibleMotions = false;

                    const dateMatch = !dateValue || meetingDate.includes(dateValue);
                    
                    if (!dateMatch) {
                        meeting.style.display = 'none';
                        return;
                    }

                    motions.forEach(motion => {
                        const title = motion.querySelector('.motion-title').textContent.toLowerCase();
                        const description = motion.querySelector('.motion-description').textContent.toLowerCase();
                        const metaElement = motion.querySelector('.motion-meta');
                        const metaText = metaElement ? metaElement.textContent.toLowerCase() : '';
                        const members = Array.from(motion.querySelectorAll('.member-name')).map(m => m.textContent.toLowerCase());
                        
                        let motionStatus = '';
                        if (motion.classList.contains('passed')) motionStatus = 'passed';
                        else if (motion.classList.contains('failed')) motionStatus = 'failed';
                        else if (motion.classList.contains('tabled')) motionStatus = 'tabled';

                        let memberMatch = true;
                        if (memberValue) {
                            const motionMembers = motion.getAttribute('data-motion-members');
                            memberMatch = motionMembers && motionMembers.includes(memberValue + ':');
                        }

                        const searchMatch = !searchTerm || 
                            title.includes(searchTerm) || 
                            description.includes(searchTerm) || 
                            metaText.includes(searchTerm) ||
                            members.some(member => member.includes(searchTerm));
                        
                        const statusMatch = !statusValue || motionStatus === statusValue;

                        if (searchMatch && statusMatch && memberMatch) {
                            motion.style.display = 'block';
                            meetingHasVisibleMotions = true;
                            
                            if (memberValue) {
                                const memberVotes = motion.querySelectorAll('.member-vote');
                                memberVotes.forEach(memberVote => {
                                    const memberName = memberVote.getAttribute('data-member');
                                    if (memberName === memberValue) {
                                        memberVote.style.background = '#e6fffa';
                                        memberVote.style.borderRadius = '8px';
                                        memberVote.style.border = '2px solid #38b2ac';
                                    } else {
                                        memberVote.style.background = 'white';
                                        memberVote.style.border = 'none';
                                    }
                                });
                            } else {
                                const memberVotes = motion.querySelectorAll('.member-vote');
                                memberVotes.forEach(memberVote => {
                                    memberVote.style.background = 'white';
                                    memberVote.style.border = 'none';
                                });
                            }
                        } else {
                            motion.style.display = 'none';
                        }
                    });

                    if (meetingHasVisibleMotions || meeting.querySelector('.status-upcoming')) {
                        meeting.style.display = 'block';
                        visibleCount++;
                    } else {
                        meeting.style.display = 'none';
                    }
                });

                this.toggleNoResultsMessage(visibleCount, searchTerm, statusValue, memberValue, dateValue);
            }

            toggleNoResultsMessage(visibleCount, searchTerm, statusValue, memberValue, dateValue) {
                const meetingsContainer = document.getElementById('meetingsContainer');
                let noResultsMsg = document.querySelector('.no-results');
                
                if (visibleCount === 0 && (searchTerm || statusValue || memberValue || dateValue)) {
                    if (!noResultsMsg) {
                        noResultsMsg = document.createElement('div');
                        noResultsMsg.className = 'no-results';
                        noResultsMsg.innerHTML = '<h3>No results found</h3><p>Try adjusting your search terms or filters.</p>';
                        meetingsContainer.appendChild(noResultsMsg);
                    }
                } else if (noResultsMsg) {
                    noResultsMsg.remove();
                }
            }

            addHoverEffects() {
                setTimeout(() => {
                    document.querySelectorAll('.motion-item').forEach(item => {
                        item.addEventListener('mouseenter', function() {
                            this.style.transform = 'translateX(5px) scale(1.01)';
                        });
                        
                        item.addEventListener('mouseleave', function() {
                            this.style.transform = 'translateX(0) scale(1)';
                        });
                    });
                }, 500);
            }

            hideLoading() {
                document.getElementById('loadingIndicator').style.display = 'none';
            }

            showError(message) {
                const container = document.querySelector('.container');
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.innerHTML = `<h3>Error</h3><p>${message}</p>`;
                
                const loadingEl = document.getElementById('loadingIndicator');
                container.insertBefore(errorDiv, loadingEl.nextSibling);
                loadingEl.style.display = 'none';
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new DunwoodyVotingTracker();
        });

        // Animate stats on page load
        window.addEventListener('load', () => {
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(stat => {
                const finalValue = parseInt(stat.textContent);
                if (finalValue === 0) return;
                
                let currentValue = 0;
                const increment = finalValue / 50;
                
                const timer = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= finalValue) {
                        stat.textContent = finalValue;
                        clearInterval(timer);
                    } else {
                        stat.textContent = Math.floor(currentValue);
                    }
                }, 20);
            });
        });
    </script>
</body>
</html>
                        